%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#e8f5e9', 'primaryTextColor': '#2e7d32', 'primaryBorderColor': '#4caf50', 'lineColor': '#78909c', 'secondaryColor': '#e3f2fd', 'tertiaryColor': '#fff'}}}%%
flowchart TB
    subgraph API["ì™¸ë¶€ API"]
        A1["TikTok API"]
        A2["Ensemble API"]
        A3["EchoTik API"]
        A4["Web Scraper"]
    end

    subgraph BATCH["Spring Boot Batch"]
        B["âš™ï¸ Parallel + Retry<br/>+ Scheduler"]
    end

    subgraph INFRA["ì¸í”„ë¼"]
        C1[("ğŸ”’ Redis Lock<br/>ì¤‘ë³µ ë°©ì§€")]
        C2[("ğŸ—„ï¸ MySQL<br/>ì›ë³¸ ì €ì¥")]
        C3[("â˜ï¸ S3<br/>ì´ë¯¸ì§€")]
        C4[("ğŸ” Elasticsearch<br/>ê²€ìƒ‰ ìµœì í™”")]
    end

    A1 & A2 & A3 & A4 --> B
    B <-.-> C1
    B --> C2 & C3
    C2 --> C4

    subgraph RESULT["âœ… ì„±ê³¼"]
        R1["ì¼ 5,000ëª…+ ìë™ ìˆ˜ì§‘"]
        R2["ê²€ìƒ‰ ì‘ë‹µ 1ì´ˆ ì´ë‚´"]
        R3["ë°ì´í„° í’€ 20ë°° í™•ëŒ€"]
    end

    C4 --> RESULT

    style B fill:#e8f5e9,stroke:#4caf50,stroke-width:2px
    style C4 fill:#e3f2fd,stroke:#1976d2
    style RESULT fill:#c8e6c9,stroke:#4caf50
